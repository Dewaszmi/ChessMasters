{% load static %}
<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>Trainer Dashboard</title>

  <style>
    body { font-family: Arial; background:#f4f4f4; padding:40px; }
    table { width: 80%; margin:auto; border-collapse:collapse; background:white; }
    th, td { padding:10px; border:1px solid #ccc; text-align:center; }
    th { background:#eee; }
    h1 { text-align:center; }
  </style>
</head>
<body>

<h1>Trainer Dashboard</h1>
<a href="{% url 'logout' %}">Logout</a>


<h2>Create group</h2>
<input type="text" id="group-name" placeholder="Group name">
<button onclick="createGroup()">Create</button>

<ul id="group-list">
  {% for g in groups %}
    <li data-id="{{ g.id }}">{{ g.name }}</li>
  {% endfor %}
</ul>

<h2>Students</h2>
<table>
  <tr>
    <th>Login</th>
    <th>Group</th>
    <th>Assign</th>
  </tr>

  {% for s in students %}
  <tr data-student="{{ s.id }}">
    <td>{{ s.username }}</td>
    <td class="current-group">
      {% if s.student_group.first %}
        {{ s.student_group.first.name }}
      {% else %}
        â€”
      {% endif %}
    </td>
    <td>
      <select class="group-select">
        {% for g in groups %}
          <option value="{{ g.id }}">{{ g.name }}</option>
        {% endfor %}
      </select>
      <button onclick="assignStudent({{ s.id }}, this)">Add</button>
    </td>
  </tr>
  {% endfor %}
</table>


<h2>Results</h2>
<table>
  <tr>
    <th>Student</th>
    <th>Level</th>
    <th>Score</th>
    <th>Avg time</th>
    <th>Date</th>
  </tr>

  {% for r in results %}
  <tr>
    <td>{{ r.user.username }}</td>
    <td>{{ r.level }}</td>
    <td>{{ r.score }}/5</td>
    <td>{{ r.avg_time }} s</td>
    <td>{{ r.created_at }}</td>
  </tr>
  {% empty %}
  <tr><td colspan="5">No results found.</td></tr>
  {% endfor %}
</table>

  <script>
    window.AJAX_CREATE_GROUP_URL = "{% url 'ajax_create_group' %}";
    window.AJAX_ASSIGN_STUDENT_URL = "{% url 'ajax_assign_student' %}";
  </script>

  <script src="{% static 'chess_app/js/trainer.js' %}"></script>
</body>
</html>
